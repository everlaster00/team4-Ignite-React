// npx prisma migrate dev --schema=./prisma/Main.prisma --name message
// npx prisma migrate reset --schema=./prisma/Main.prisma
// npx prisma generate --schema=./prisma/Main.prisma
generator Main_client {
  provider = "prisma-client-js"
  output = "../src/generated/prisma-client/main"
}

datasource Main_db {
  provider  = "postgresql"
  url       = env("MAIN_DATABASE_URL")
  directUrl = env("MAIN_DIRECT_URL")
}

// 아래 데이터 베이스의 내용이 수정 될 때마다
// npx prisma migrate dev --name 작업내역메시지
// 배포된 환경에서는 npx prisma migrate deploy

//# 마지막 마이그레이션 되돌리기. 롤백용 (개발 환경) (경고: 모든 데이터 손실))
// npx prisma migrate reset

// 데이터베이스 작성 예제
enum Role {
  USER
  ADMIN
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique           // 로그인 필수
  name      String
  roll      Role     @default(USER)
  createdAt DateTime @default(now())

  // name은 검색 빈도에 따라 결정
  // @@index([name])  // 자주 검색하면 추가
}

model Post {
  id        Int      @id @default(autoincrement())
  title     String
  content   String
  authorId  Int
  status    String   // 'DRAFT', 'PUBLISHED'
  createdAt DateTime @default(now())

  // 복합 인덱스: 동시에 자주 사용
  @@index([authorId, status])

  // 단일 인덱스: 정렬용
  @@index([createdAt(sort: Desc)])
}

model Comment {
  id        Int      @id @default(autoincrement())
  postId    Int
  userId    Int
  content   String
  createdAt DateTime @default(now())

  @@index([postId])     // 게시글의 댓글 조회
  @@index([userId])     // 사용자의 댓글 조회
}
